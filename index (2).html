<!DOCTYPE html>
 <html>
      <head class="col-md-4" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
          <meta property="og:type" content="article" />
          <meta property="og:url" content="http://goodchiang.github.io/finalProjectTest/" />
          <meta property="og:title" content="Selfie With Me / NCCU Web Programming" />
          <meta property="og:description" content="Facebook Open Graph Test" />
          <meta property="og:image" content="http://goodchiang.github.io/finalProjectTest/img/img.png" />
          <!--https://developers.facebook.com/docs/reference/opengraph/object-type/article-->
          <meta charset="utf-8">
          <title>來一起自拍！</title>
          <meta name="viewport" content="width=device-width">
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
          <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
          <link rel="stylesheet" href="css/index.css">
          <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
          <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
          <script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.4.2.min.js"></script>
          <script src="js/keyNew.js"></script> 
      </head>

      <body>
          
              <nav class="navbar navbar-default navbar-fixed-top">
                  <div class="container">
                      <!-- Brand and toggle get grouped for better mobile display -->
                      <div class="navbar-header page-scroll">
                          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                              <span class="sr-only">Toggle navigation</span>
                              <span class="icon-bar"></span>
                              <span class="icon-bar"></span>
                              <span class="icon-bar"></span>
                          </button>
                          <a class="navbar-brand" href="#page-top">Start Bootstrap</a>
                      </div>

                      <!-- Collect the nav links, forms, and other content for toggling -->
                      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                          <ul class="nav navbar-nav navbar-right">
                              <li class="hidden">
                                  <a href="#page-top"></a>
                              </li>
                              <li class="page-scroll">
                                  <a href="#portfolio">Portfolio</a>
                              </li>
                              <li class="page-scroll">
                                  <a href="#about">About</a>
                              </li>
                              <li class="page-scroll">
                                  <a href="#contact">Contact</a>
                              </li>
                          </ul>
                      </div>
                      <!-- /.navbar-collapse -->
                  </div>
                  <!-- /.container-fluid -->
              </nav>             
          


          
                  



              <div class="container">

                  <!-- Page Heading -->
                  <div class="row">
                      <div class="col-lg-12">
                          <h1 class="page-header">Page Heading
                              <small>Secondary Text</small>
                          </h1>
                      </div>
                  </div>
                  <!-- /.row -->

                  <!-- Projects Row -->
                  <div class="row">
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                  </div>
                  <!-- /.row -->

                  <hr>

                  <!-- Projects Row -->
                  <div class="row">
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                  </div>
                  <!-- /.row -->

                  <hr>

                  <!-- Projects Row -->
                  <div class="row">
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                      <div class="col-md-3 portfolio-item">
                          <a href="#">
                              <img class="img-responsive" src="http://placehold.it/750x450" alt="">
                          </a>
                      </div>
                  </div>
                  <!-- /.row -->

                  <hr>

                  <!-- Pagination -->
                  <div class="row text-center">
                      <div class="col-lg-12">
                          <ul class="pagination">
                              <li>
                                  <a href="#">&laquo;</a>
                              </li>
                              <li class="active">
                                  <a href="#">1</a>
                              </li>
                              <li>
                                  <a href="#">2</a>
                              </li>
                              <li>
                                  <a href="#">3</a>
                              </li>
                              <li>
                                  <a href="#">4</a>
                              </li>
                              <li>
                                  <a href="#">5</a>
                              </li>
                              <li>
                                  <a href="#">&raquo;</a>
                              </li>
                          </ul>
                      </div>
                  </div>
                  <!-- /.row -->
                  </div>
                  </section>




          <footer>
              <div class="col-md-12 copyright"> Copyright © 2015 NCCU DAC Web Programing Group 1. All Rights Reserved.</div>
          </footer>
    













          <script>
              //step1:https://www.parse.com/docs/js/guide#users-facebook-users
              // Initialize Parse
              Parse.initialize("3Ct29PJCet8L8kfhLvbLTJ3DLKRC61RAp7ysXFU6", "3yHxjy4EBgJTMWYBuP1T7rG4qOHiiOuAnokZB5jb");
              window.fbAsyncInit = function() {
                  Parse.FacebookUtils.init({ // this line replaces FB.init({
                      appId      : '1070568829637766', // Facebook App ID
                      status     : true,  // check Facebook Login status
                      cookie     : true,  // enable cookies to allow Parse to access the session
                      xfbml      : true,  // initialize Facebook social plugins on the page
                      version    : 'v2.3' // point to the latest Facebook Graph API version
                  });
                  // Run code after the Facebook SDK is loaded.
              };
              (function(d, s, id){
                  var js, fjs = d.getElementsByTagName(s)[0];
                  if (d.getElementById(id)) {return;}
                  js = d.createElement(s); js.id = id;
                  js.src = "//connect.facebook.net/en_US/sdk.js";
                  fjs.parentNode.insertBefore(js, fjs);
                  }(document, 'script', 'facebook-jssdk'));


              function fblogin(){
                  //step2:https://developers.facebook.com/docs/graph-api/using-graph-api/v2.3 
                  Parse.FacebookUtils.logIn(null, {
                      success: function(user) {
                          if (!user.existed()) {
                              alert("註冊完成並且透過臉書登入");
                          } else {
                              alert("透過臉書登入成功");
                          }
                          indexView();//切換至預先寫好登入後的介面
                          FB.getLoginStatus(function(response) {
                              if (response.status === 'connected') {
                                  FB.api('/me/picture?type=large', function (response) {
                                      $('#fbPic').html("<img src="+response.data.url+" crossorigin=\"anonymous\" id=preview1 />");          
                                  });
                             
                                  FB.api('/me', function (response) {
                                      console.log(response);
                                      $('#fbImgView').append("<h1>Welcome , "+(response['gender']=="male"?"Mr. ":"Miss ")+" "+response['first_name']+"</h1>");
                                  });            
                              }
                          }); 
                      },
                      error: function(user, error) {
                          alert("使用者取消登入或沒有授權");
                      }
                  });
              }
              
              $(document).ready(function(){
                  console.log(Parse.User.current());
                  var Comment = Parse.Object.extend("Comment") ;
                  var queryComments = new Parse.Query (Comment) ;

                  queryComments.find({
                      success : function(arrayOfQueriedObjects){
                          console.log (arrayOfQueriedObjects);
            
                          for (var i = 0 ; i < arrayOfQueriedObjects.length ; i++){
                              comment = arrayOfQueriedObjects[i] ;
                              $("#comments").append("<blockquote>"+"<img src='"+ comment.get("img").url()+"' height='100px'>"+ "</blockquote>");
                          }
                      },
                      error : function(errorObject){
                          alert(errorObject.message) ;
                      }
                  });
              });


           </script>
           <script src="js/logIn.js"></script>        
    </body>
</html>